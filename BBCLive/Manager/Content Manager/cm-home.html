<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./../../Manager/Content Manager/cmstyles/css/cm-home.css">
  <title>HOME</title>
</head>

<body>
  <header class="top-nav">
    <div class="header-container">
      <nav>
        <div class="header-logo">   
          <a href=".">
            <img src="../../res/slu-logo.png" alt="slu-Logo">
          </a>
        </div>
        
        <ul>
          <li><a href="cm-home.html">Home</a></li>
          <li><button onclick="goToResources()" id="btn">Resources</button></li>
          <li><a href="cm-logs.html">Logs</a></li>
        </ul>
        
        <div class="header-profile">
          <!-- <img src="pathofdadp" alt="user-dp"> -->
          <div id="cmDetails" class="cmDets">
            <!-- Content manager avatar and name will be displayed here -->
          </div>
          <div class="line"></div>
          <div class="user-info">
            <a href="">Username</a>
            <button id="logoutBtn" onclick="logout()">Logout</button>
          </div>
        </div>
      </nav>
    </div>
  </header>
  
  
  
  <section>
    <h1>Home</h1>
    <div class="container" id="tablesContainer">
      <table>
        <!-- Table headers -->
        <tr>
          <th>Time</th>
          <th>Title</th>
        </tr>
        <!-- Table rows -->
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        <tr>
          <td></td>
          <td></td>
        </tr>
        
        <!-- Repeat rows as needed -->
        
      </table>
    </div>
    
    <button id="addTableBtn" onclick="addTable()">Add Table (temporary button)</button>
    <!--Resources Redirect Button-->
    <!-- <button onclick="goToResources()">Resources</button> -->
    <!-- Logout button -->
    
  </section>
  
  <script>
    function addTable() {
      var newTable = document.createElement("table");
      var headerRow = newTable.insertRow(0);
      
      var headerCell1 = document.createElement("th");
      headerCell1.innerHTML = "Time";
      headerRow.appendChild(headerCell1);
      
      var headerCell2 = document.createElement("th");
      headerCell2.innerHTML = "Title";
      headerRow.appendChild(headerCell2);
      
      for (var i = 0; i < 7; i++) {
        var dataRow = newTable.insertRow(i + 1);
        var dataCell1 = dataRow.insertCell(0);
        var dataCell2 = dataRow.insertCell(1);
        dataCell1.innerHTML = "";
        dataCell2.innerHTML = "";
      }
      
      document.getElementById("tablesContainer").appendChild(newTable);
    }
    
    // Function to fetch and display content manager details
    function displayCmDetails() {
      // Make an AJAX request to the endpoint that provides content manager details
      fetch('/getCmDetails')
      .then(response => response.json())
      .then(cmDetails => {
        // Update the HTML with content manager details
        const cmDetailsDiv = document.getElementById('cmDetails');
        cmDetailsDiv.innerHTML = `
        <img src="./../../${cmDetails.dp}" class="avatar" alt="Avatar">
        ${cmDetails.firstname} ${cmDetails.lastname}
        `;
      })
      .catch(error => {
        console.error('Error fetching content manager details:', error);
      });
    }
    
    // Call the function to display content manager details on page load
    displayCmDetails();
    
    // Function to handle redirect to resources.html
    function goToResources() {
      // Make an AJAX request to the server to handle the redirection
      fetch('/gotoresources')
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          // Redirect to resources.html after successful request
          window.location.href = '/Manager/Content%20Manager/resources.html';
        } else {
          alert('Failed to go to Resources');
        }
      })
      .catch(error => {
        console.error('Error during request to go to Resources:', error);
      });
    }
    
    // Function to handle logout
    function logout() {
      // Make an AJAX request to the logout endpoint
      fetch('/logout')
      .then(response => response.json())
      .then(data => {
        console.log('Logout response:', data);
        if (data.success) {
          alert('Logout successful');
          // Redirect to the login page after successful logout
          window.location.href = '/';
        } else {
          alert('Logout failed');
        }
      })
      .catch(error => {
        console.error('Error during logout:', error);
      });
    }
    
  </script>
</body>

</html>